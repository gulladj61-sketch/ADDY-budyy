<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Addy Bot AI Studio â€” Live (Paste your keys)</title>
<meta name="description" content="Addy Bot â€” paste OpenAI & ElevenLabs keys in Settings (session only) to run 20 tools, chat and TTS directly from mobile browser." />
<style>
:root{
  --bg:#050617; --panel:#0f1724; --accent:#7c3aed; --muted:#9aa4b2;
  --glass:rgba(255,255,255,0.03);
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto;background:linear-gradient(180deg,var(--bg),#021028);color:#eaf1ff;-webkit-font-smoothing:antialiased}
.container{max-width:1100px;margin:14px auto;padding:14px}
.header{display:flex;align-items:center;justify-content:space-between;gap:12px}
.brand{display:flex;gap:12px;align-items:center}
.logo{width:54px;height:54px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#06b6d4);display:flex;align-items:center;justify-content:center;font-weight:800;color:#031026}
.title{font-weight:800;font-size:18px}
.sub{color:var(--muted);font-size:13px}
.controls{display:flex;gap:8px;align-items:center}
.btn{background:linear-gradient(90deg,var(--accent),#06b6d4);border:none;padding:9px 12px;border-radius:10px;color:#031026;font-weight:800;cursor:pointer}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
.grid{display:grid;grid-template-columns:1fr 360px;gap:14px;margin-top:14px}
@media(max-width:980px){.grid{grid-template-columns:1fr} .right{width:100%}}
.panel{background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
.chat{display:flex;flex-direction:column;height:520px}
.chatwin{flex:1;overflow:auto;padding:12px;border-radius:8px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)}
.msg{max-width:78%;padding:10px;border-radius:10px;margin:8px 0;line-height:1.4}
.user{margin-left:auto;background:linear-gradient(90deg,#00c897,#00f5a0);color:#021613}
.bot{background:rgba(255,255,255,0.02)}
.controls-row{display:flex;gap:8px;align-items:center;margin-top:10px}
.input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
.tools{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:8px;margin-top:12px}
.tool{background:rgba(255,255,255,0.01);padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.02);cursor:pointer}
.small{font-size:13px;color:var(--muted)}
.notice{font-size:13px;color:#f59e0b;margin-top:8px}
.hint{font-size:12px;color:var(--muted)}
.badge{background:#111827;color:#f8fafc;padding:8px 12px;border-radius:999px;font-weight:800}
.footer{margin-top:14px;color:var(--muted);font-size:13px;text-align:center}
.kv{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.preview{background:rgba(255,255,255,0.01);padding:8px;border-radius:8px;margin-top:8px;color:var(--muted)}
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">
        <div class="logo">AD</div>
        <div>
          <div class="title">Addy Bot AI Studio</div>
          <div class="sub">Full live tools â€” paste keys in Settings (session only)</div>
        </div>
      </div>

      <div class="controls">
        <div class="kv"><div class="badge">$20,000</div></div>
        <button class="btn" id="openSettings">Settings</button>
      </div>
    </div>

    <div class="grid">
      <div>
        <div class="panel chat">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:800">Chat â€” Addy Bot (Live)</div>
            <div class="small" id="envStatus">keys: not set</div>
          </div>

          <div class="chatwin" id="chatwin" aria-live="polite">
            <div class="msg bot">Welcome â€” open Settings and paste your OpenAI API key (session). Then try Chat or any Tool.</div>
          </div>

          <div class="controls-row">
            <input id="chatInput" class="input" placeholder="Type message..." />
            <button class="btn ghost" id="micBtn">ðŸŽ¤</button>
            <button class="btn" id="sendBtn">Send</button>
          </div>
          <div class="hint">Mobile tip: paste keys in Settings, then tap "Test Keys". Use session storage for mobile safety.</div>
        </div>

        <div class="panel" style="margin-top:12px">
          <div style="font-weight:800">Tools â€” 20 Live Tools</div>
          <div class="small">Click a tool â†’ enter prompt â†’ Run. Tools call OpenAI in the browser using your session key.</div>
          <div class="tools" id="tools"></div>
          <div id="toolPanel" style="margin-top:12px"></div>
          <div class="notice" id="corsNotice" style="display:none">Warning: If ElevenLabs TTS blocked by CORS, use the server proxy (click Settings â†’ Show Proxy).</div>
        </div>
      </div>

      <aside class="right">
        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:800">Settings (Session Keys)</div>
            <div class="small">No keys included â€” paste yours</div>
          </div>

          <div style="margin-top:10px;display:flex;flex-direction:column;gap:8px">
            <label class="hint">OpenAI API key (sk-...)</label>
            <input id="openaiInput" class="input" placeholder="sk-..." />
            <label class="hint">ElevenLabs API key (xi-api-key-...)</label>
            <input id="elevenInput" class="input" placeholder="xi-api-key-..." />
            <label class="hint">ElevenLabs voice id (optional)</label>
            <input id="elevenVoice" class="input" placeholder="voice id" />

            <div style="display:flex;gap:8px;margin-top:6px">
              <button class="btn" id="saveSession">Save to session</button>
              <button class="btn ghost" id="clearSession">Clear</button>
            </div>

            <div style="display:flex;gap:8px;margin-top:6px">
              <button class="btn ghost" id="testKeys">Test Keys</button>
              <button class="btn ghost" id="showProxy">Show server proxy (if needed)</button>
            </div>

            <div class="preview" id="previewBox">Status: session empty</div>
            <div class="hint">Security: sessionStorage keeps keys only for this tab session. Do NOT paste keys on public/shared devices.</div>
          </div>
        </div>

        <div class="panel" style="margin-top:12px">
          <div style="font-weight:800">Quick actions</div>
          <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn" id="downloadReadme">Download README</button>
            <button class="btn ghost" id="previewListing">Preview Listing</button>
          </div>
          <div class="preview" id="listingPreview"></div>
        </div>

        <div class="panel" style="margin-top:12px">
          <div style="font-weight:800">Owner</div>
          <input id="brandName" class="input" value="Addy Bot AI Studio" />
          <input id="ownerName" class="input" value="Addy" style="margin-top:8px"/>
        </div>
      </aside>
    </div>

    <div class="footer">Â© <span id="yr"></span> Addy Bot â€” For production deploy server proxy (I can provide). Do NOT commit keys to GitHub.</div>
  </div>

<script>
/* Single-file live Addy Bot (browser-keys, sessionStorage)
   IMPORTANT: I WILL NOT INCLUDE KEYS. Paste your own keys into Settings -> Save to session.
   After saving, press 'Test Keys'. If keys OK, chat & tools will call OpenAI from browser.
   If ElevenLabs TTS blocked by CORS, click "Show server proxy" and I will give you server code to deploy.
*/

document.getElementById('yr').innerText = new Date().getFullYear();

/* Tool list */
const TOOLS = [
  {id:'writer', label:'AI Writer'},
  {id:'code', label:'Code Helper'},
  {id:'prompt', label:'Prompt Maker'},
  {id:'translate', label:'Translator'},
  {id:'imageprompt', label:'Image Prompt'},
  {id:'summarize', label:'Summarizer'},
  {id:'seo', label:'SEO Title'},
  {id:'ideas', label:'Business Ideas'},
  {id:'story', label:'Story Maker'},
  {id:'study', label:'Study Helper'},
  {id:'email', label:'Email Writer'},
  {id:'adcopy', label:'Ad Copy'},
  {id:'regex', label:'Regex Maker'},
  {id:'motivate', label:'Motivator'},
  {id:'character', label:'Character Chat'},
  {id:'numsupport', label:'Support Reply'},
  {id:'tweet', label:'Tweet Composer'},
  {id:'summarize-long', label:'Long Summarizer'},
  {id:'translate-brief', label:'Translator (brief)'},
  {id:'tts', label:'Voice TTS'}
];

/* populate tools UI */
const toolsDiv = document.getElementById('tools');
TOOLS.forEach(t => {
  const el = document.createElement('div'); el.className = 'tool';
  el.innerHTML = `<div style="font-weight:700">${t.label}</div><div class="small">Run</div>`;
  el.onclick = () => openTool(t);
  toolsDiv.appendChild(el);
});

/* session key helpers */
function saveSessionKeys(){
  const o = document.getElementById('openaiInput').value.trim();
  const e = document.getElementById('elevenInput').value.trim();
  const v = document.getElementById('elevenVoice').value.trim();
  if(o) sessionStorage.setItem('ADDY_OPENAI', o); else sessionStorage.removeItem('ADDY_OPENAI');
  if(e) sessionStorage.setItem('ADDY_ELEVEN', e); else sessionStorage.removeItem('ADDY_ELEVEN');
  if(v) sessionStorage.setItem('ADDY_VOICE', v); else sessionStorage.removeItem('ADDY_VOICE');
  updateEnvStatus();
  alert('Keys saved for this session only.');
}
function clearSessionKeys(){
  sessionStorage.removeItem('ADDY_OPENAI'); sessionStorage.removeItem('ADDY_ELEVEN'); sessionStorage.removeItem('ADDY_VOICE');
  document.getElementById('openaiInput').value=''; document.getElementById('elevenInput').value=''; document.getElementById('elevenVoice').value='';
  updateEnvStatus();
  alert('Session keys cleared.');
}
function loadSessionInputs(){
  document.getElementById('openaiInput').value = sessionStorage.getItem('ADDY_OPENAI') || '';
  document.getElementById('elevenInput').value = sessionStorage.getItem('ADDY_ELEVEN') || '';
  document.getElementById('elevenVoice').value = sessionStorage.getItem('ADDY_VOICE') || '';
  updateEnvStatus();
}
function updateEnvStatus(){
  const hasO = !!sessionStorage.getItem('ADDY_OPENAI');
  const hasE = !!sessionStorage.getItem('ADDY_ELEVEN');
  document.getElementById('envStatus').innerText = `keys: OpenAI ${hasO?'âœ“':'âœ—'} / Eleven ${hasE?'âœ“':'âœ—'}`;
  document.getElementById('previewBox').innerText = `OpenAI: ${hasO?'saved in session':'not saved'} â€¢ Eleven: ${hasE?'saved in session':'not saved'}`;
}

/* load on start */
loadSessionInputs();

/* save / clear buttons */
document.getElementById('saveSession').addEventListener('click', saveSessionKeys);
document.getElementById('clearSession').addEventListener('click', clearSessionKeys);
document.getElementById('openSettings').addEventListener('click', ()=> window.scrollTo({top:0,behavior:'smooth'}));

/* Test keys function */
document.getElementById('testKeys').addEventListener('click', async ()=>{
  const ok = await testOpenAIKey();
  if(ok) alert('OpenAI key OK â€” tools should work.');
  else alert('OpenAI key failed â€” check key or network. If  CORS or auth errors occur, consider server proxy.');
});

/* show proxy instructions */
document.getElementById('showProxy').addEventListener('click', ()=> {
  const txt = `Proxy server hides keys & avoids CORS. Reply here "READY FOR PROXY" and I will give you a ready-to-deploy server.js + package.json.`;
  alert(txt);
});

/* Chat flow */
const chatWin = document.getElementById('chatwin');
const chatIn = document.getElementById('chatInput');
document.getElementById('sendBtn').addEventListener('click', sendChat);
chatIn.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ e.preventDefault(); sendChat(); }});

async function sendChat(){
  const text = chatIn.value.trim(); if(!text) return;
  appendMsg(text,'user'); chatIn.value='';
  const t = appendTyping();
  try{
    const reply = await runOpenAIChat([{role:'user', content:text}], 600);
    t.remove(); appendMsg(reply,'bot');
    // TTS: try Eleven first, else browser speak
    await tryElevenThenBrowser(reply);
  }catch(e){
    t.remove(); appendMsg('[Error] '+String(e),'bot');
  }
}

/* append helpers */
function appendMsg(text, who){
  const d = document.createElement('div'); d.className = 'msg ' + (who==='user' ? 'user' : 'bot'); d.innerText = text; chatWin.appendChild(d); chatWin.scrollTop = chatWin.scrollHeight;
}
function appendTyping(){ const el=document.createElement('div'); el.className='msg bot typing'; el.innerText='Addy is thinking...'; chatWin.appendChild(el); chatWin.scrollTop = chatWin.scrollHeight; return el; }

/* Tool UI */
function openTool(tool){
  const panel = document.getElementById('toolPanel');
  panel.innerHTML = '';
  const wrap = document.createElement('div'); wrap.className='panel';
  wrap.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:800">${tool.label}</div><div class="small">Live</div></div>
    <div style="margin-top:8px"><textarea id="toolInp" rows="5" style="width:100%;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:inherit" placeholder="Enter input for ${tool.label}"></textarea></div>
    <div style="display:flex;gap:8px;margin-top:8px"><button id="runTool" class="btn">Run</button><button id="copyTool" class="btn ghost">Copy</button></div>
    <div style="margin-top:8px"><textarea id="toolOut" rows="8" style="width:100%;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:inherit" readonly></textarea></div>`;
  panel.appendChild(wrap);

  document.getElementById('runTool').addEventListener('click', async ()=>{
    const v = document.getElementById('toolInp').value.trim();
    document.getElementById('toolOut').value = 'Running...';
    try{
      const out = await runTool(tool.id, v);
      document.getElementById('toolOut').value = out;
    }catch(err){
      document.getElementById('toolOut').value = 'Error: '+String(err);
    }
  });
  document.getElementById('copyTool').addEventListener('click', ()=>{
    navigator.clipboard.writeText(document.getElementById('toolOut').value||'');
    document.getElementById('copyTool').innerText='Copied'; setTimeout(()=>document.getElementById('copyTool').innerText='Copy',900);
  });
}

/* tool prompt mapping */
function toolPrompt(id,input){
  input = input || '';
  switch(id){
    case 'writer': return `Write a short blog intro and 5-point outline about: ${input}`;
    case 'code': return `Help debug / suggest fixes for: ${input}`;
    case 'prompt': return `Create a detailed image prompt for: ${input}`;
    case 'translate': return `Translate to Hindi and give an English paraphrase:\n\n${input}`;
    case 'imageprompt': return `Create 3 image prompts for: ${input}`;
    case 'summarize': case 'summarize-long': return `Summarize into key bullets:\n\n${input}`;
    case 'seo': return `Create 3 SEO titles for: ${input}`;
    case 'ideas': return `Give 5 concise business ideas for: ${input}`;
    case 'story': return `Write a short creative story: ${input}`;
    case 'study': return `Explain simply with example: ${input}`;
    case 'email': return `Draft a professional email for: ${input}`;
    case 'adcopy': return `Write ad copy for: ${input}`;
    case 'regex': return `Provide regex for: ${input}`;
    case 'motivate': return `Write a short motivational message for: ${input}`;
    case 'character': return `Roleplay as: ${input}`;
    case 'numsupport': return `Write a support reply: ${input}`;
    case 'tweet': return `Write a tweet about: ${input}`;
    case 'tts': return `${input}`;
    default: return input;
  }
}

/* run tool via OpenAI (browser call with session key) */
async function runTool(id, input){
  const key = sessionStorage.getItem('ADDY_OPENAI');
  if(!key) throw new Error('OpenAI key not set in Settings.');
  const prompt = toolPrompt(id,input);
  const messages = [{role:'system',content:'You are Addy Tools assistant.'},{role:'user',content:prompt}];
  const reply = await callOpenAI(messages, 700);
  return reply;
}

/* call OpenAI chat completions via fetch */
async function callOpenAI(messages, max_tokens=500){
  const key = sessionStorage.getItem('ADDY_OPENAI');
  if(!key) throw new Error('OpenAI key missing in session.');
  const model = 'gpt-4o-mini'; // change if needed
  const body = { model, messages, max_tokens };
  const resp = await fetch('https://api.openai.com/v1/chat/completions', {
    method:'POST',
    headers:{ 'Content-Type':'application/json', 'Authorization':'Bearer '+key },
    body: JSON.stringify(body)
  });
  if(!resp.ok){
    const txt = await resp.text().catch(()=>resp.statusText);
    // Provide helpful message for CORS / auth
    if(resp.status === 401) throw new Error('OpenAI auth failed â€” check key.');
    if(resp.status === 429) throw new Error('OpenAI rate limit / quota exceeded.');
    throw new Error('OpenAI error: '+txt);
  }
  const j = await resp.json();
  const msg = j.choices?.[0]?.message?.content || (j.error?.message || JSON.stringify(j));
  return msg;
}

/* OpenAI chat wrapper for sendChat/voice */
async function runOpenAIChat(messages, max_tokens=500){
  return await callOpenAI(messages, max_tokens);
}

/* ElevenLabs TTS call (browser). May be blocked by CORS. If CORS blocks, show notice to use server proxy. */
async function callElevenTTS(text){
  const key = sessionStorage.getItem('ADDY_ELEVEN');
  const vid = sessionStorage.getItem('ADDY_VOICE');
  if(!key || !vid) throw new Error('Eleven key or voice id not set in session (optional).');
  const url = `https://api.elevenlabs.io/v1/text-to-speech/${encodeURIComponent(vid)}`;
  const r = await fetch(url, {
    method:'POST',
    headers:{ 'Content-Type':'application/json', 'xi-api-key': key, 'Accept':'audio/mpeg' },
    body: JSON.stringify({ text })
  });
  if(!r.ok){
    const t = await r.text().catch(()=>r.statusText);
    // show proxy hint
    document.getElementById('corsNotice').style.display = 'block';
    throw new Error('ElevenLabs error: '+t);
  }
  const blob = await r.blob();
  const u = URL.createObjectURL(blob);
  const a = new Audio(u); await a.play(); setTimeout(()=>URL.revokeObjectURL(u),60000);
}

/* try Eleven then fallback to browser TTS */
async function tryElevenThenBrowser(text){
  try{
    await callElevenTTS(text);
  }catch(e){
    console.warn('eleven fail, fallback', e);
    // fallback to browser TTS
    if('speechSynthesis' in window){
      const utt = new SpeechSynthesisUtterance(text); utt.lang='en-US'; speechSynthesis.cancel(); speechSynthesis.speak(utt);
    }
  }
}

/* send chat */
async function sendChat(){
  const txt = document.getElementById('chatInput').value.trim(); if(!txt) return;
  appendMsg(txt,'user'); document.getElementById('chatInput').value='';
  const t = appendTyping();
  try{
    const reply = await runOpenAIChat([{role:'user',content:txt}], 600);
    t.remove(); appendMsg(reply,'bot');
    await tryElevenThenBrowser(reply);
  }catch(e){
    t.remove(); appendMsg('[Error] '+String(e),'bot');
  }
}

/* helper append */
function appendMsg(text, who){
  const d = document.createElement('div'); d.className='msg ' + (who==='user'?'user':'bot'); d.innerText = text; chatWin.appendChild(d); chatWin.scrollTop = chatWin.scrollHeight;
}
function appendTyping(){ const el=document.createElement('div'); el.className='msg bot typing'; el.innerText='Addy is thinking...'; chatWin.appendChild(el); chatWin.scrollTop = chatWin.scrollHeight; return el; }

/* test OpenAI key quick */
async function testOpenAIKey(){
  const key = sessionStorage.getItem('ADDY_OPENAI');
  if(!key) return false;
  try{
    const r = await fetch('https://api.openai.com/v1/chat/completions', {
      method:'POST',
      headers:{ 'Content-Type':'application/json','Authorization':'Bearer '+key },
      body: JSON.stringify({ model:'gpt-4o-mini', messages:[{role:'user',content:'Say hello in one sentence.'}], max_tokens:20 })
    });
    if(!r.ok){ console.warn('test key fail', r.status); return false; }
    const j = await r.json();
    return !!(j.choices && j.choices[0] && j.choices[0].message);
  }catch(e){
    console.warn('test key error', e); return false;
  }
}

/* small utilities and event wiring */
document.getElementById('saveSession').addEventListener('click', saveSessionKeys);
document.getElementById('clearSession').addEventListener('click', clearSessionKeys);
document.getElementById('sendBtn').addEventListener('click', sendChat);
document.getElementById('testKeys').addEventListener('click', async ()=>{
  const ok = await testOpenAIKey();
  if(ok) { alert('OpenAI key working'); updateEnvStatus(); } else { alert('OpenAI key failed or CORS blocked. Consider server proxy.'); }
});
document.getElementById('downloadReadme').addEventListener('click', ()=>{
  const brand = document.getElementById('brandName').value || 'Addy Bot AI Studio';
  const owner = document.getElementById('ownerName') ? document.getElementById('ownerName').value : 'Addy';
  const txt = `${brand} â€” README\nAuthor: ${owner}\nInstructions: Paste your OpenAI key in Settings (session). For production, deploy a server proxy to keep keys safe.`;
  const blob = new Blob([txt], {type:'text/plain'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='README.txt'; a.click(); URL.revokeObjectURL(url);
});
document.getElementById('previewListing').addEventListener('click', ()=>{
  const brand = document.getElementById('brandName').value || 'Addy Bot AI Studio';
  const out = `${brand} â€” Live multi-tool AI dashboard. Market value: $20,000 (listing assets included). Single-file frontend ready.`;
  document.getElementById('listingPreview').innerText = out;
});

/* keyboard focus */
document.addEventListener('keydown', (e)=>{ if(e.key==='/' && document.activeElement !== document.getElementById('chatInput')){ e.preventDefault(); document.getElementById('chatInput').focus(); } });

/* initial environment update */
updateEnvStatus();

/* end of script */
</script>
</body>
</html>
